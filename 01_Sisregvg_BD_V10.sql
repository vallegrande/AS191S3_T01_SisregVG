/* Base de datos: DBSISREGVG */

-- Desde conexión system

-- Crear espacio DBSISREGVG
CREATE TABLESPACE DBSISREGVG
DATAFILE 'C:\oraclexe\app\oracle\oradata\XE\DBSISREGVG.dbf'
SIZE 512M
AUTOEXTEND ON;

-- Crear usuario
CREATE USER DBSISREGVG
IDENTIFIED BY root
DEFAULT TABLESPACE DBSISREGVG
TEMPORARY TABLESPACE TEMP
QUOTA UNLIMITED ON DBSISREGVG;

-- Conceder privilegios al usuario
GRANT DBA, CONNECT, RESOURCE TO DBSISREGVG;

-- Desde conexión a nuevo usuario

/* Creación de las tablas */
-- Table: UBIGEO
CREATE TABLE UBIGEO (
    CODUBI CHAR(6) NOT NULL,
    PROUBI varchar(150)  NOT NULL,
    DEPUBI varchar(150)  NOT NULL,
    DISUBI varchar(150)  NOT NULL,
    CONSTRAINT UBIGEO_pk PRIMARY KEY (CODUBI)
);

CREATE TABLE PERSONAL (
	IDPER integer  NOT NULL,
	NOMPER VARCHAR2 (90)  NOT NULL,
	APEPER VARCHAR2 (90) NOT NULL,
	DNIPER CHAR (8) UNIQUE NOT NULL,
	CELPER CHAR (9) UNIQUE NOT NULL,
	EMAPER  VARCHAR2(90) UNIQUE NOT NULL,
	CODUBI CHAR(6) NOT NULL,
    DOMPER varchar2(120) NOT NULL,
	SEXPER  CHAR (1) NOT NULL,
	CARPER   VARCHAR2 (15) NOT NULL,
	ESTPER char(1) NOT NULL,
	CONSTRAINT PERSONAL_pk PRIMARY KEY(IDPER)
);

--  Create table CENTROCOSTO 
CREATE TABLE CENTROCOSTO (
    CODCEN char(6) NOT NULL,
    DESCEN varchar2(150)  NOT NULL,
    ARECEN varchar2(150)  NOT NULL,
    CONSTRAINT CENTROCOSTO_pk PRIMARY KEY (CODCEN)
);

--  Create table ValeProvisional 
CREATE TABLE VALEPROVISIONAL (
	IDVAL integer  NOT NULL, 
	IMPVAL DECIMAL(5,2) NOT NULL,
	FECVAL DATE NOT NULL,
	CODCEN CHAR(6) NOT NULL,
	PROVAL VARCHAR2(150) NOT NULL,
	ACTVAL VARCHAR2(200) NOT NULL,
	IDPER  integer NOT NULL,
	ESTVAL CHAR(1) NOT NULL,
    CONSTRAINT ValeProvisional_pk PRIMARY KEY (IDVAL)
);


-- Create Table: Liquidacion
CREATE TABLE LIQUIDACION(
    IDLIQ integer NOT NULL,
    IDVAL integer NOT NULL, 
    MOTLIQ varchar2 (150) NOT NULL, 
    FECLIQ date NOT NULL,  
    CODCEN char(6) NOT NULL,
    FORLIQ varchar2 (30) NOT NULL,
    GASLIQ decimal(10,2)  NOT NULL,
    SALLIQ decimal(10,2) NOT NULL,
    ESTLIQ char(1) NOT NULL,
    CONSTRAINT Liquidacion_pk PRIMARY KEY (IDLIQ)
);



--  Create table REEMBOLSO
CREATE TABLE REEMBOLSO (
    IDREE integer  NOT NULL,
    IDLIQ integer NOT NULL,
    MOTREE varchar2(200) NOT NULL,
    FECREE DATE  NOT NULL,
    CODCEN char(6) NOT NULL,
    FORREE VARCHAR2(20)  NOT NULL,
    PAGREE varchar2(10) NOT NULL, 
    NAHREE VARCHAR2(25)  NOT NULL,
    NCUREE varchar2 (15)NOT NULL,
    SALREE decimal(10,2) NOT NULL,
    ESTREE CHAR(1)  NOT NULL,
   CONSTRAINT REEMBOLSO_pk PRIMARY KEY (IDREE)
);


--  Create table DEJURADA
CREATE TABLE DEJURADA (
    IDDEJ integer NOT NULL,
    IMPDEJ DECIMAL(5,2) NOT NULL,
    PRODEJ VARCHAR2(150) NOT NULL,
    CODCEN char(6) NOT NULL,
    IDPER INTEGER NOT NULL,
    RECDEJ DECIMAL(5,2) NOT NULL,
    CONDEJ VARCHAR(150) NOT NULL,
    FECDEJ DATE NOT NULL,
    ESTDEJ char (1),
   CONSTRAINT DEJURADA_pk PRIMARY KEY (IDDEJ)
);

--  Create table USUARIO
CREATE TABLE USUARIO (
    IDUSU integer,
    IDPER integer,
    USUUSU varchar2(8),
    PWDUSU varchar2(15),
    LEVUSU integer ,
    ESTUSU char (1),
    CONSTRAINT USUARIO_pk PRIMARY KEY (IDUSU)
);

-- RELACIONANDOLO 
-- Relacionar la tabla UBIGEO a PERSONAL 
ALTER TABLE PERSONAL
ADD CONSTRAINT FK_PERSONAL_UBIGEO
FOREIGN KEY (CODUBI) REFERENCES UBIGEO (CODUBI);

-- Relacionar la tabla Personal a Usuario 
ALTER TABLE Usuario
ADD CONSTRAINT FK_Usuario_PERSONAL
FOREIGN KEY (IDPER) REFERENCES PERSONAL (IDPER);

-- Relacionar la tabla Personal a ValeProvisional 
ALTER TABLE ValeProvisional
ADD CONSTRAINT FK_ValeProvisional_PERSONAL
FOREIGN KEY (IDPER) REFERENCES PERSONAL (IDPER);

-- Relacionar la tabla Personal a Liquidacion
ALTER TABLE Liquidacion
ADD CONSTRAINT FK_Liquidacion_ValeProvisional
FOREIGN KEY (IDVAL) REFERENCES ValeProvisional (IDVAL);

-- Relacionar la tabla Liquidacion a Reembolso 
ALTER TABLE Reembolso
ADD CONSTRAINT FK_Rembolso_Liquidacion
FOREIGN KEY (IDLIQ) REFERENCES Liquidacion (IDLIQ);

-- Relacionar la tabla CENTROCOSTO a ValeProvisional 
ALTER TABLE ValeProvisional
ADD CONSTRAINT FK_ValeProvisional_CENTROCOSTO
FOREIGN KEY (CODCEN) REFERENCES CENTROCOSTO (CODCEN);

-- Relacionar la tabla CENTROCOSTO a Reembolso
ALTER TABLE Reembolso
ADD CONSTRAINT FK_Reembolso_CENTROCOSTO
FOREIGN KEY (CODCEN) REFERENCES CENTROCOSTO (CODCEN);


-- Relacionar la tabla CENTROCOSTO a LIQUIDACION
ALTER TABLE LIQUIDACION
ADD CONSTRAINT FK_LIQUIDACION_CENTROCOSTO
FOREIGN KEY (CODCEN) REFERENCES CENTROCOSTO (CODCEN);

-- Relacionar la tabla CENTROCOSTO a DEJURADA
ALTER TABLE DEJURADA
ADD CONSTRAINT FK_DEJURADA_CENTROCOSTO
FOREIGN KEY (CODCEN) REFERENCES CENTROCOSTO (CODCEN);


CREATE SEQUENCE IDPERSONAL
START WITH 1
INCREMENT BY 1
ORDER;

CREATE SEQUENCE IDVALEPROVISIONAl
START WITH 1
INCREMENT BY 1
ORDER;

CREATE SEQUENCE IDLIQUIDACION
START WITH 1
INCREMENT BY 1
ORDER;

CREATE SEQUENCE IDREEMBOLSO
START WITH 1
INCREMENT BY 1
ORDER;

CREATE SEQUENCE IDUSUARIO
START WITH 1
INCREMENT BY 1
ORDER;

CREATE SEQUENCE IDDEJURADA
START WITH 1
INCREMENT BY 1
ORDER;

CREATE OR REPLACE TRIGGER TGR_IDPERSONAL
BEFORE INSERT ON PERSONAL
FOR EACH ROW
BEGIN
SELECT IDPERSONAL.NEXTVAL INTO :NEW.IDPER FROM DUAL;
END;
/

CREATE OR REPLACE TRIGGER TGR_IDVALEPROVISIONAl
BEFORE INSERT ON ValeProvisional
FOR EACH ROW
BEGIN
SELECT IDVALEPROVISIONAl.NEXTVAL INTO :NEW.IDVAL FROM DUAL;
END;
/

CREATE OR REPLACE TRIGGER TGR_IDLIQUIDACION
BEFORE INSERT ON Liquidacion
FOR EACH ROW
BEGIN
SELECT IDLIQUIDACION.NEXTVAL INTO :NEW.IDLIQ FROM DUAL;
END;
/


CREATE OR REPLACE TRIGGER TGR_IDREEMBOLSO
BEFORE INSERT ON REEMBOLSO
FOR EACH ROW
BEGIN
SELECT IDREEMBOLSO.NEXTVAL INTO :NEW.IDREE FROM DUAL;
END;
/

CREATE OR REPLACE TRIGGER TGR_IDUSUARIO
BEFORE INSERT ON USUARIO
FOR EACH ROW
BEGIN
SELECT IDUSUARIO.NEXTVAL INTO :NEW.IDUSU FROM DUAL;
END;
/

CREATE OR REPLACE TRIGGER TGR_IDDEJURADA
BEFORE INSERT ON DEJURADA
FOR EACH ROW
BEGIN
SELECT IDDEJURADA.NEXTVAL INTO :NEW.IDDEJ FROM DUAL;
END;
/
--Insertando registros en la tabla UBIGEO :)
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150501','LIMA','CAÑETE','SAN VICENTE');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150502','LIMA','CAÑETE','ASIA');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150503','LIMA','CAÑETE','CALANGO');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150504','LIMA','CAÑETE','CERRO AZUL');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150505','LIMA','CAÑETE','CHILCA');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150506','LIMA','CAÑETE','COAYLLO');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150507','LIMA','CAÑETE','IMPERIAL');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150508','LIMA','CAÑETE','LUNAHUANA');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150509','LIMA','CAÑETE','MALA');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150510','LIMA','CAÑETE','NUEVO IMPERIAL');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150511','LIMA','CAÑETE','PACARAN');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150512','LIMA','CAÑETE','QUILMANA');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150513','LIMA','CAÑETE','SAN ANTONIO');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150514','LIMA','CAÑETE','SAN LUIS');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150515','LIMA','CAÑETE','SANTA CRUZ DE FLORES');
INSERT INTO UBIGEO (CODUBI,DEPUBI,PROUBI,DISUBI) VALUES ('150516','LIMA','CAÑETE','ZUÑIGA');

-- INSERTAR REGISTROS EN LA TABKA PERSONAL :)
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Juan Marcos', 'Rodriguez Quispe', '74143340','961270878','juan.rodrigues@vallegrande.edu.pe','150501','Jiron La Unión Mz:D Lt:02','M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Carl Sinól', 'Sanchez Pardo', '74153320','961243876','carl.sanchez@vallegrande.edu.pe', '150502','Benavides Mz:A Lt:09','M', 'Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Frank Marmol', 'Beltrán Escalante', '76213428','961457989','frank@felipe@vallegrande.edu.pe','150503','Av. Coronel Mz:B Lt:01','M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Mateo Miklo', 'Vidal Burquéz', '76520530','961245767','mateo.vidal@vallegrande.edu.pe','150504','Jiron Arteaga Mz:O Lt:03', 'M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Flavio Francisco', 'Huaman Zambrano', '76438332','961043530','flavio.huaman@vallegrande.edu.pe','150508','Av 9 de diciembre Mz:P Lt:08', 'M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Lenox Beltrán', 'Zuriaga Barton', '74153027','961243870','lenox.zuriaga@vallegrande.edu.pe', '150509','Av. Los Laureles Mz:','M', 'Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Franklin Malla', 'Murieta Malcón', '76210123','961457981','franklin.murieta@vallegrande.edu.pe','150510', 'Av. 2 de Mayo Mz:J Lt:02','M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Martin Chiklo', 'Mollo Cardenaz', '76038539','961245763','martin.mollo@vallegrande.edu.pe','150511', 'Jr. Laura Caller Mz:M Lt:04','M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES ( 'Renato Mendives', 'Hurtado Lozano', '76430530','961043531','renato.hurtado@vallegrande.edu.pe','150513','Av. Molinares Mz:T Lt:04', 'M','Monitor','A');
INSERT INTO PERSONAL (NOMPER, APEPER, DNIPER, CELPER, EMAPER, CODUBI, DOMPER, SEXPER, CARPER, ESTPER)
VALUES (  'Miguel Magallanes',  'Manco Villalobos', '71149384','976283910','ruben.manco@vallegrande.edu.pe','150512','Jr. Laura Caller Mz:M Lt:03', 'M','Monitor','A');


-- INSERTAR REGISTROS EN LA TABKA CENTROCOSTO :)
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100201','ENERGIA ELECTRICA - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100202','RPM - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100203','SOFWARE DE GESTIÓN ACADEMICA Q10 - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100204','VISITAS DE ESTUDIOS (NT)  - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100205','TERTULIAS PROFESIONALES (NT) - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100206','CURSO/CHARLA TECNICO (NT) - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100207','MATERIALES E INSUMOS (UD) - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100208','MONITOREO Y EVALUACIÓN DE PRÁCTICAS - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100209','CAPACITACIÓN DE MONITORES - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100210','SERVICIOS DE ACREDITACIÓN - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100211','COMPRA DE LIBROS DE INGLES - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100212','GASTOS DE VIAJE DE ESTUDIO (NT) - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100213','CICLO CERO ANÁLISIS DE SISTEMAS - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100214','UNIFORMES - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('100215','RECURSOS DIGITALES / BASE DE DATOS - PA','Carrera Profesional de Producción Agraria');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200201','ENERGIA ELECTRICA - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200202','RPM - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200203','SOFWARE DE GESTIÓN ACADEMICA Q10 - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200204','VISITAS DE ESTUDIOS (NT) - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200205','TERTULIAS PROFESIONALES (NT) - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200206','CURSO/CHARLA TECNICO (NT) - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200207','MATERIALES E INSUMOS (UD)  - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200208','MONITOREO Y EVALUACIÓN DE PRÁCTICAS - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200209','CAPACITACIÓN DE MONITORES - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200210','SERVICIOS DE ACREDITACIÓN - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200211','COMPRA DE LIBROS DE INGLES - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200212','GASTOS DE VIAJE DE ESTUDIO (NT) - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200213','CICLO CERO ANÁLISIS DE SISTEMAS - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200214','UNIFORMES - PA','Carrera Profesional de Análisis de Sistemas');
INSERT INTO CENTROCOSTO (CODCEN, DESCEN, ARECEN)
VALUES ('200215','RECURSOS DIGITALES / BASE DE DATOS - PA','Carrera Profesional de Análisis de Sistemas');



-- INSERTAR REGISTROS DE VALEPROVISIONAL
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('100,00','01-09-2020','100203','Proyecto1','Compra de material para taller','1','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('90,00','02-10-2020','100204','Proyecto2','Compra de artefacto para computo','2','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('80,00','03-09-2020','100205','Proyecto3','Compra de monitores','3','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('70,00','04-09-2020','100207','Proyecto4','Compra de teclados para computo','4','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('60,00','05-07-2020','100203','Proyecto1','Compra de material para laboratorio','5','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('50,00','06-06-2020','100207','Proyecto2','Compra de artefacto para sala de computo','6','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('40,00','07-03-2020','100208','Proyecto3','Compra de monitores para laboratorio','7','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('30,00','08-05-2020','100209','Proyecto4','Compra de teclados para computo','8','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('20,00','09-04-2020','100210','Proyecto3','Compra de monitores y cpu para sala decomputo','9','A');
INSERT INTO ValeProvisional (IMPVAL, FECVAL, CODCEN, PROVAL, ACTVAL, IDPER,ESTVAL)
VALUES ('10,00','24-02-2020','100211','Proyecto4','Compra de teclados para computo','10','A');



-- INSERTAR REGISTROS DE LIQUIDACION
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('1','Monitoreo a lugares SBS Chilca, Mala, Cañete y Yauyos','06-02-2021','200201','Soles','200,00','50,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('2','Monitoreo a lugares SBS Ica, Mala, Cañete y Yauyos','20-05-2021','200202','USD','160,00','20,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('3','Monitoreo a lugares SBS Chinca, Mala, Cañete y Yauyos','19-03-2021','200203','Soles','150,00','30,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('4','Monitoreo a lugares SBS Cañete, Mala, Cañete y Yauyos','12-05-2021','200204','Soles','140,00','70,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('5','Monitoreo a lugares SBS Chilcal, Mala, Cañete y Yauyos','26-04-2021','200201','Soles','200,00','50,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('6','Monitoreo a lugares SBS Ica, Mala, Cañete y Yauyos','25-07-2021','200202','USD','160,00','20,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('7','Monitoreo a lugares SBS Chinca, Mala, Cañete y Yauyos','29-07-2021','200203','Soles','150,00','30,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('8','Monitoreo a lugares SBS Hualcara, Mala, Cañete y Yauyos','12-08-2021','200204','Soles','140,00','70,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('9','Monitoreo a lugares SBS Chincha alta, Mala, Cañete y Yauyos','17-05-2021','200203','Soles','150,00','30,00','A');
INSERT INTO Liquidacion (IDVAL,MOTLIQ,FECLIQ,CODCEN,FORLIQ, GASLIQ, SALLIQ,ESTLIQ)
VALUES ('10','Monitoreo a lugares SBS Piura, Mala, Cañete y Yauyos','02-04-2021','200204','Soles','140,00','70,00','A');


-- INSERTAR REGISTROS DE REEMBOLSO
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '1', 'Compra de materiales para computo','20-02-2021','200201','SOLES','E','A','103489782Y','126,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '2',  'Compra de materiales para laboratorio','10-05-2021','200202','SOLES','E','A','103489782Y','106,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '3', 'Compra de materiales','22-02-2021','200203','SOLES','C','A','103489782Y','120,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '4',  'Compra de materiales','19-09-2021','200204','SOLES','E','A','103489782Y','129,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '5', 'Compra de materiales para computo','29-04-2021','200205','SOLES','E','A','103489782Y','126,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '6',  'Compra de materiales para laboratorio','15-05-2021','200202','SOLES','E','A','103489782Y','106,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '7', 'Compra de materiales','22-02-2021','200206','SOLES','C','A','103489782Y','120,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '8',  'Compra de materiales','29-09-2021','200207','SOLES','E','A','103489782Y','129,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '9', 'Compra de materiales','24-02-2021','200208','SOLES','C','A','103489782Y','120,00','A');
INSERT INTO REEMBOLSO (IDLIQ, MOTREE,FECREE,CODCEN,FORREE, PAGREE, NAHREE,NCUREE, SALREE, ESTREE)
VALUES ( '10',  'Compra de materiales','09-09-2021','200209','SOLES','E','A','103489782Y','129,00','A');


-- INSERTAR REGISTROS DE DEJURADA 
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('15,00','Visita de Estudio','200211','1','20,00','Almuerzo en restaurante','02-09-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('15,00','Visita de Estudio','200212','2','30,00','Almuerzo en restaurante','01-09-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('20,00','Viaje de Estudio','200203','3','80,00','Pasaje de estudiantes y profesores','13-02-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('20,00','Charlas técnicas','200204','4','70,00','Charlas técnicas Preprofesionales<','12-02-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('30,00','Visita de Estudio','200205','5','60,00','Almuerzo en restaurante','11-02-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('10,00','Practicas en Empresas','200206','6','50,00','Prácticas Preprofesionales','10-05-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('29,00','Visita de Estudio','200207','7','40,00','Almuerzo en restaurante','16-11-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('45,00','Visita de Estudio','200208','8','30,00','Almuerzo en restaurante','25-10-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('29,00','Visita de Estudio','200209','9','20,00','Almuerzo en restaurante','10-06-2021','A');
INSERT INTO DEJURADA (IMPDEJ, PRODEJ, CODCEN, IDPER, RECDEJ, CONDEJ,FECDEJ,ESTDEJ)
VALUES ('15,00','Visita de Estudio','200210','10','10,00','Almuerzo en restaurante','05-09-2021','A');

-- Registro de USUARIO
INSERT INTO USUARIO (IDPER, USUUSU , PWDUSU, LEVUSU, ESTUSU)
VALUES ('1','PEPIT', 'grillo2020','1','A');
INSERT INTO USUARIO (IDPER, USUUSU , PWDUSU,LEVUSU, ESTUSU)
VALUES ('2','RAMOS', 'ramos2021','2','A');
INSERT INTO USUARIO (IDPER, USUUSU , PWDUSU,LEVUSU, ESTUSU)
VALUES ('3','PINTO', '12345','2','A');
INSERT INTO USUARIO (IDPER, USUUSU , PWDUSU,LEVUSU, ESTUSU)
VALUES ('4','caracol', '1357','2','A');



--Creación de Vistas Personal
CREATE VIEW vPersonal
AS
SELECT
     P.IDPER AS IDPER, 
     INITCAP(P.NOMPER) AS NOMPER,
     INITCAP(P.APEPER) AS APEPER,
	 P.DNIPER AS DNIPER,
	 P.CELPER AS CELPER,
	 P.EMAPER AS EMAPER, 
     P.CODUBI AS CODUBI,
     U.DISUBI AS DISUBI,
	 U.PROUBI AS PROUBI,
	 U.DEPUBI AS DEPUBI,
	 P.DOMPER AS DOMPER,
	 P.SEXPER AS SEXPER,
	 P.CARPER AS CARPER,
	 P.ESTPER AS ESTPER,
	 ROW_NUMBER() OVER (ORDER BY P.IDPER DESC) AS ORDEN
FROM 
     Personal P
 INNER JOIN UBIGEO U ON
	 P.CODUBI = U.CODUBI;


--Vistas Vale Provisional
CREATE VIEW vValeProvisional
AS
SELECT
	 V.IDVAL AS IDVAL,
	 V.IMPVAL AS IMPVAL,
     V.FECVAL AS FECVAL,
     C.DESCEN AS DESCEN,
     C.CODCEN AS CODCEN,
     C.ARECEN AS ARECEN,
	 V.PROVAL AS PROVAL,
	 V.ACTVAL AS ACTVAL,
     INITCAP(P.NOMPER)  AS NOMPER,
     INITCAP(P.APEPER) AS APEPER,
    V.ESTVAL AS ESTVAL,
	 ROW_NUMBER() OVER (ORDER BY V.IDVAL DESC) AS ORDEN
FROM 
     ValeProvisional  V
	 INNER JOIN PERSONAL P ON
	 V.IDPER = P.idper
    INNER JOIN CENTROCOSTO C ON
    V.CODCEN =  C.CODCEN;



CREATE VIEW vLiquidacion
AS
SELECT
	 L.IDLIQ AS IDLIQ,
     INITCAP(P.NOMPER)  AS NOMPER,
     INITCAP(P.APEPER) AS APEPER,
	 P.dniper AS dniper,
     V.FECVAL AS FECVAL,
	 V.IDVAL AS IDVAL,
	 L.MOTLIQ AS MOTLIQ,
     L.FECLIQ AS FECLIQ,
      C.DESCEN AS DESCEN,
     C.CODCEN AS CODCEN,
     C.ARECEN AS ARECEN,
	 L.FORLIQ AS FORLIQ,
	 V.IMPVAL AS IMPVAL,
	 L.GASLIQ AS GASLIQ,
	 (V.IMPVAL - L.GASLIQ) AS SALLIQ,	
	 L.ESTLIQ AS ESTLIQ,
     ROW_NUMBER() OVER (ORDER BY L.IDLIQ DESC) AS ORDEN
FROM 
     Liquidacion  L
	  INNER JOIN ValeProvisional  V ON
	 L.IDVAL = V.IDVAL
	  INNER JOIN PERSONAL  P ON
	 V.IDPER = P.idper
	   INNER JOIN CENTROCOSTO  C ON
	 L.CODCEN = C.CODCEN;

--Creación de las Vistas REEMBOLSO 
CREATE VIEW vREEMBOLSO
AS
SELECT
	 R.IDREE AS IDREE,
	 INITCAP(P.NOMPER) AS NOMPER,
	 P.DNIPER AS DNIPER,
	 R.MOTREE AS MOTREE,
     R.FECREE AS FECREE,
     C.DESCEN AS DESCEN,
     C.CODCEN AS CODCEN,
     C.ARECEN AS ARECEN,
	 L.IDLIQ AS IDLIQ,
	 R.FORREE AS FORREE,
	 R.PAGREE AS PAGREE,
	 R.NAHREE AS NAHREE,
	 R.NCUREE AS NCUREE,
	 (L.GASLIQ- V.IMPVAL ) AS SALREE,
	 R.ESTREE AS ESTREE,
	 ROW_NUMBER() OVER (ORDER BY R.IDREE DESC) AS ORDEN
FROM 
     REEMBOLSO  R
	  INNER JOIN Liquidacion L ON
	  R.IDLIQ = L.IDLIQ 
	  INNER JOIN ValeProvisional  V ON
	 L.IDVAL = V.IDVAL
	  INNER JOIN PERSONAL  P ON
	 V.IDPER = P.idper
          INNER JOIN CENTROCOSTO C ON
	 L.CODCEN = C.CODCEN;


--Creación de las Vistas ValeUltimo ID
CREATE VIEW VALE_ULTIMOID
AS
SELECT * FROM 
(SELECT 
     V.IDVAL AS IDVAL,
     V.IMPVAL AS IMPVAL,
     TO_CHAR( V.FECVAL, 'DD-MON-YYYY') AS FECVAL,
     C.DESCEN AS DESCEN,
     C.CODCEN AS CODCEN,
     C.ARECEN AS ARECEN,
     V.PROVAL AS PROVAL,
     V.ACTVAL AS ACTVAL,
	 INITCAP(P.NOMPER) || ' ' || INITCAP(P.APEPER) AS NOMPER
FROM 
    ValeProvisional V
     INNER JOIN Personal P ON
	 V.IDPER = P.IDPER
   INNER JOIN CENTROCOSTO C ON
	 V.CODCEN = C.CODCEN
ORDER BY
     V.IDVAL DESC) WHERE rownum <= 1;




--Creación de las Vistas vDEJURADA 
CREATE VIEW vDEJURADA
AS
SELECT
	 D.IDDEJ AS IDDEJ,
     D.IMPDEJ AS IMPDEJ,
     D.PRODEJ AS PRODEJ,
     C.DESCEN AS DESCEN,
     C.CODCEN AS CODCEN,
     C.ARECEN AS ARECEN,
	 INITCAP(P.NOMPER)  AS NOMPER,
     INITCAP(P.APEPER) AS APEPER,
	 D.RECDEJ AS RECDEJ,
	 D.CONDEJ AS CONDEJ,
     D. FECDEJ AS FECDEJ,
	 D.ESTDEJ AS ESTDEJ,
	 ROW_NUMBER() OVER (ORDER BY D.IDDEJ DESC) AS ORDEN
FROM 
     DEJURADA  D
	  INNER JOIN CENTROCOSTO C ON
	  D.CODCEN = C.CODCEN 
	  INNER JOIN PERSONAL  P ON
	 D.IDPER = P.IDPER;



CREATE VIEW vRoLUsuario
AS
SELECT
     U.USUUSU AS USUUSU,
     U.PWDUSU AS PWDUSU,
     P.CARPER AS CARPER
FROM 
     USUARIO U
	 INNER JOIN PERSONAL P ON
	 U.IDPER = P.IDPER;
