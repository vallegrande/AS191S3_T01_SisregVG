<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">

    <h:head>
        <title>Listado del Personal</title>
        <f:event listener="#{personaC.listar()}" type="preRenderView" />
    </h:head>
    <h:body>      
        <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces" />

        <!--        <h:form>
                    <p:breadCrumb>         
                        <p:menuitem icon="pi pi-home" value="Categories" url="http://localhost:8080/Sisregvg/faces/vistas/Menu.xhtml" />
                        <p:menuitem value="Menú" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Menu.xhtml" />             
                        <p:menuitem value="Documentos" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Documentos.xhtml" />
                        <p:menuitem value="DeJurada" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/DeJurada.xhtml" />    
                        <p:menuitem value="Reembolso" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Reembolso.xhtml" /> 
                        <p:menuitem value="ValeProvisional" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/ValeProvisional.xhtml" /> 
                    </p:breadCrumb>  
                </h:form>-->




        <!--        <h:form>
                    <p:breadCrumb>         
                        <p:menuitem icon="pi pi-home" value="Categories" url="http://localhost:8080/Sisregvg/faces/vistas/Menu.xhtml" />
                        <p:menuitem value="Menú" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Menu.xhtml" />             
                        <p:menuitem value="Documentos" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Documentos.xhtml" />
                        <p:menuitem value="DeJurada" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/DeJurada.xhtml" />    
                        <p:menuitem value="Reembolso" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Reembolso.xhtml" /> 
                        <p:menuitem value="ValeProvisional" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/ValeProvisional.xhtml" /> 
                    </p:breadCrumb>  
                </h:form>-->


        <h:form>
            <p:panelMenu style="width:250px">
                <p:submenu label="Sisregvg" >            
                    <p:menuitem value="Documentos" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Documentos.xhtml" />
                    <p:menuitem value="DeJurada" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/DeJurada.xhtml" />    
                    <p:menuitem value="Reembolso" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/Reembolso.xhtml" /> 
                    <p:menuitem value="ValeProvisional" url="http://localhost:8080/Sisregvg_Maven/faces/vistas/ValeProvisional.xhtml" />
                </p:submenu>
            </p:panelMenu>
        </h:form>



        <p:growl id="mensaje" showDetail="true" />
        <p:growl id="growl-sticky" for="sticky-key" showDetail="true" sticky="true" />

        <h:form id="form">
            <center>
                <!--    Formulario del personal    >-->         
                <p:panelGrid columns="4">
                    <f:facet name= "header"> DATOS DEl PERSONAL </f:facet> 

                    <p:outputLabel value="Nombre" />
                    <p:inputText id="Txtnombre"  value="#{personaC.per.nombre}" maxlength="30"  required="true" requiredMessage="Digitar el nombre">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_ ]/"/>
                    </p:inputText>     
                    <p:outputLabel value="Apellidos" />
                    <p:inputText value="#{personaC.per.apellido}" maxlength="30"   required="true" requiredMessage="Digitar el apellido">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_ ]/"/>
                    </p:inputText>
                    <p:outputLabel value="DNI" />
                    <p:inputText value="#{personaC.per.dni}" maxlength="8"  required="true" requiredMessage="Digitar el dni">
                        <p:keyFilter regEx="/[0-9]/" />
                        <f:validateLength minimum="8"/>
                    </p:inputText>                  
                    <p:outputLabel value="Celular" />
                    <p:inputText value="#{personaC.per.celular}" maxlength="9"   required="true" requiredMessage="Digitar el celular">
                        <p:keyFilter regEx="/[0-9]/" />
                        <f:validateLength minimum="9"/>
                    </p:inputText>  
                    <p:outputLabel value="Email" />
                    <p:inputText value="#{personaC.per.email}" maxlength="50"   required="true" requiredMessage="Digitar el email">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_0_:_@_._-]/"/>                     
                    </p:inputText>
                    <p:outputLabel value="Sexo" />
                    <p:selectOneRadio id="sexo" value="#{personaC.per.sexo}"  required="true" requiredMessage="Digitar el sexo">
                        <f:selectItem itemLabel="Masculino" itemValue="M" />
                        <f:selectItem itemLabel="Femenino" itemValue="F" />
                    </p:selectOneRadio>
                    <p:outputLabel value="Cargo" />
                    <p:selectOneMenu id="option" value="#{personaC.per.cargo}"  required="true" requiredMessage="Digitar el cargo" >
                        <f:selectItem itemLabel="Seleccionar" itemValue=""/>
                        <f:selectItem itemLabel="Trabajador" itemValue="Trabajador"/>
                        <f:selectItem itemLabel="Jefe de Área" itemValue="Jefe de Área"/>
                        <f:selectItem itemLabel="Director" itemValue="Director"/>
                    </p:selectOneMenu>
                    <p:commandButton value="Registrar" actionListener="#{personaC.registrar()}" update="form :formtwo:tablaPer mensaje"  style="background-color:  background"/>
                    <!--<p:commandButton value="Listar" actionListener="{personeroC.listar()}" update="tablaPer" />-->

                </p:panelGrid>

            </center>
            <!--    Formulario del personal   >-->
        </h:form>


            <h:form id="formDescargaPersona">
                <p:commandButton value="Exportar Personas" actionListener="#{personaC.reportePersona()}" 
                                 ajax="false" style="background-color:yellowgreen;color:black;font-weight:bold;"/>
            </h:form>
            <h:form>  
                <p:panelGrid columns="2">               
                    <h:commandLink value="Descargar">
                        <h:graphicImage width="50px" url="./../recursos/pdf.png"/>
                        <p:dataExporter type='pdf' target=":formtwo:tablaPer" fileName="Lista del Personal" pageOnly="true" />              
                    </h:commandLink>  

                    <h:commandLink value="Descargar">
                        <h:graphicImage width="50px" url="./../recursos/xls.png"/>
                        <p:dataExporter type="xls" target=":formtwo:tablaPer" fileName="Lista del Personal" pageOnly="true"   />              
                    </h:commandLink>       
                </p:panelGrid>
            </h:form>  




        <h:form id="formtwo">
            <!--              Listado del personal-->
            <p:dataTable var="tblpers" id="tablaPer" value="#{personaC.listadoPer}" rows="10" 
                         paginator="true" widgetVar="tblPersonal" selection="#{personaC.per}" 
                         resizableColumns="true" 
                         selectionMode="single"
                         rowKey="#{tblpers.codigo}"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                         rowsPerPageTemplate="5,10,{ShowAll|'All'}" 
                         rowStyleClass="registroVinculado">

                <f:facet name="header">
                    <p:outputPanel>
                        <h:outputText value="Buscar:"/>
                        <h:inputText id="globalFilter" onkeyup="PF('tblPersonal').filter()" style="width:200px"/>
                    </p:outputPanel>
                </f:facet>


                <f:facet name= "header" > LISTADO DEL PERSONAL REGISTRADO  </f:facet> 

                <!--                        <p:column style="width:10px" headerText="Id">
                                            <h:outputText value="#{tblpers.codigo}"/>
                                        </p:column>-->

                <p:column style="width:30px" headerText="Nombre" sortBy="#{tblpers.nombre}" filterBy="#{tblpers.nombre}">
                    <h:outputText value="#{tblpers.nombre}" />
                </p:column>           
                <p:column style="width:40px" headerText="Apellido" sortBy="#{tblpers.apellido}" filterBy="#{tblpers.apellido}">
                    <h:outputText value="#{tblpers.apellido}" />
                </p:column>
                <p:column style="width:35px" headerText="Dni"  sortBy="#{tblpers.dni}" filterBy="#{tblpers.dni}">
                    <h:outputText value="#{tblpers.dni}" />
                </p:column>
                <p:column style="width:40px" headerText="Celular" sortBy="#{tblpers.celular}" filterBy="#{tblpers.celular}">
                    <h:outputText value="#{tblpers.celular}" />
                </p:column>
                <p:column style="width:110px" headerText="Email" sortBy="#{tblpers.email}" filterBy="#{tblpers.email}">
                    <h:outputText value="#{tblpers.email}" />
                </p:column>              
                <p:column style="width:45px" headerText="Sexo" sortBy="#{tblpers.sexo}" filterBy="#{tblpers.sexo}">
                    <h:outputText value="#{tblpers.sexo}" >
                        <f:converter converterId="sexoConverter"/>
                    </h:outputText>
                </p:column>             
                <p:column style="width:45px" headerText="Cargo" sortBy="#{tblpers.cargo}" filterBy="#{tblpers.cargo}">
                    <h:outputText value="#{tblpers.cargo}" />
                </p:column>           

                <f:facet name="footer">     
                    EN TOTAL HAY  #{fn:length(personaC.listadoPer)} REGISTROS.       
                </f:facet>           
            </p:dataTable>
            <!--                <p:growl id="messages" showDetail="true"/>-->

            <p:contextMenu for="tablaPer">
                <p:menuitem value="Modificar" icon="pi pi-pencil" oncomplete="PF('wdlgDatos').show()" update=":formthree">
                </p:menuitem>
                <p:menuitem value="Eliminar" icon="pi pi-trash" actionListener="#{personaC.eliminar()}" update=":formtwo:tablaPer mensaje">
                    <p:confirm header="Confirmación" message="¿Deseas eliminar?"/>                         
                </p:menuitem>
            </p:contextMenu>
            <!--            <p:menuitem value="Menú" url="http://localhost:8080/Sisregvg/faces/vistas/Menu.xhtml" icon="pi pi-home"/>
            --><!--
                                    <p:menuitem value="Documentos" url="http://localhost:8080/Sisregvg/faces/vistas/Documentos.xhtml" icon="pi pi-home"/>              
                                    <p:menuitem value="Personal" url="http://localhost:8080/Sisregvg/faces/vistas/Personal.xhtml" icon="pi pi-home"/>-->



            <!--            Listado de la persona-->
        </h:form>


        <!--DATOS DEL PERSONAL-->
        <p:dialog header="Datos del personal" widgetVar="wdlgDatos" id="dlgDatos">
            <h:form id="formthree">
                <p:panelGrid columns="2">
                    <p:outputLabel value="Nombre" />
                    <p:inputText id="Txtnombre" value="#{personaC.per.nombre}" maxlength="30"  required="true" requiredMessage="Digitar el nombre">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_ ]/"/>
                    </p:inputText>     
                    <p:outputLabel value="Apellido" />
                    <p:inputText value="#{personaC.per.apellido}" maxlength="30"   required="true" requiredMessage="Digitar el apellido">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_ ]/"/>
                    </p:inputText>
                    <p:outputLabel value="DNI" />
                    <p:inputText value="#{personaC.per.dni}" maxlength="8"  required="true" requiredMessage="Digitar el dni">
                        <p:keyFilter regEx="/[0-9]/" />
                        <f:validateLength minimum="8"/>
                    </p:inputText>                  
                    <p:outputLabel value="Celular" />
                    <p:inputText value="#{personaC.per.celular}" maxlength="9"   required="true" requiredMessage="Digitar el celular">
                        <p:keyFilter regEx="/[0-9]/" />
                        <f:validateLength minimum="9"/>
                    </p:inputText>  
                    <p:outputLabel value="Email" />
                    <p:inputText value="#{personaC.per.email}" maxlength="50"   required="true" requiredMessage="Digitar el email">
                        <p:keyFilter regEx="/[A-Z_a-z_ñ_á_é_í_ó_ú_0_:_@_._-]/"/>                     
                    </p:inputText>
                    <p:outputLabel value="Sexo" />
                    <p:selectOneRadio id="sexo" value="#{personaC.per.sexo}"  required="true" requiredMessage="Digitar el sexo">
                        <f:selectItem itemLabel="Masculino" itemValue="M" />
                        <f:selectItem itemLabel="Femenino" itemValue="F" />
                    </p:selectOneRadio>
                    <p:outputLabel value="Cargo" />
                    <p:selectOneMenu id="option" value="#{personaC.per.cargo}"  required="true" requiredMessage="Digitar el cargo" >
                        <f:selectItem itemLabel="Seleccionar" itemValue=""/>
                        <f:selectItem itemLabel="Trabajador" itemValue="Trabajador"/>
                        <f:selectItem itemLabel="Jefe de Área" itemValue="Jefe de Área"/>
                        <f:selectItem itemLabel="Director" itemValue="Director"/>
                    </p:selectOneMenu>

                    <p:commandButton value="Modificar" actionListener="#{personaC.modificar()}" 
                                     update=":formtwo:tablaPer" oncomplete="PF('wdlgDatos').hide();" >
                        <p:confirm header="Confirmación" message="¿Deseas Modificar?" icon="ui-icon-alert"/>
                        <p:tooltip trackMouse="true"/>
                    </p:commandButton>
                    <p:commandButton value="Cancelar" immediate="true" oncomplete="PF('wdlgDatos').hide();" />

                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
                    </p:confirmDialog>

                </p:panelGrid>
            </h:form>
        </p:dialog>
    </h:body>
</html>